<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41054.4016313194" ReportOptions.Description.Text="" ReportOptions.LastChange="41232.5892190509" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;var&#13;&#10;  kLuk : array [1..10] of string;&#13;&#10;  kNum : array [0..9] of string;&#13;&#10;  MyTXT: String;      &#13;&#10;&#13;&#10;function StringReplace(const S, OldPattern, NewPattern: string;): string;&#13;&#10;var&#13;&#10;  SearchStr, Patt, NewStr: string;&#13;&#10;  Offset: Integer;&#13;&#10;begin&#13;&#10;&#13;&#10;    SearchStr := S;&#13;&#10;    Patt := OldPattern;&#13;&#10;&#13;&#10;  NewStr := S;&#13;&#10;  Result := '';&#13;&#10;  while SearchStr &#60;&#62; '' do&#13;&#10;  begin&#13;&#10;    Offset := Pos(Patt, SearchStr);&#13;&#10;    if Offset = 0 then&#13;&#10;    begin&#13;&#10;      Result := Result + NewStr;&#13;&#10;      Break;&#13;&#10;    end;&#13;&#10;    Result := Result + Copy(NewStr, 1, Offset - 1) + NewPattern;&#13;&#10;    NewStr := Copy(NewStr, Offset + Length(OldPattern), 60000);&#13;&#10;&#13;&#10;    SearchStr := Copy(SearchStr, Offset + Length(Patt), 60000);&#13;&#10;  end;&#13;&#10;end;&#13;&#10;  &#13;&#10;function TextBaht(extBaht: Extended): string;&#13;&#10;var&#13;&#10;  strBaht, strStang, strTmpBaht, strTmpStang : string;&#13;&#10;  n, i : integer;&#13;&#10;begin&#13;&#10;  Result := '';&#13;&#10;&#13;&#10;  strBaht := FormatFloat('0.00',extBaht); &#13;&#10;  n := Pos('.',strBaht);  &#13;&#10;  strStang := Copy(strBaht,n+1,2); &#13;&#10;  strBaht  := Copy(strBaht,1,n-1); &#13;&#10;    &#13;&#10;  strTmpBaht := '';&#13;&#10;  i := Length(strBaht);&#13;&#10;  for n := 1 to Length(strBaht) do&#13;&#10;    begin&#13;&#10;      if (strBaht[n]='0') then&#13;&#10;        begin&#13;&#10;          if (i=7) and (strTmpBaht&#60;&#62;'') then strTmpBaht := strTmpBaht + kLuk[i];&#13;&#10;          Dec(i);&#13;&#10;          Continue;&#13;&#10;        end;&#13;&#10;      strTmpBaht := strTmpBaht + kNum[StrToInt(strBaht[n])] + kLuk[i];&#13;&#10;      Dec(i);&#13;&#10;    end;    &#13;&#10;  if (strTmpBaht &#60;&#62; '') then strTmpBaht := strTmpBaht + 'บาท';    &#13;&#10;  strTmpStang := '';    &#13;&#10;  if (strStang[1]&#60;&#62;'0') then&#13;&#10;    strTmpStang := strTmpStang + kNum[StrToInt(strStang[1])] + kLuk[2];    &#13;&#10;  if (strStang[2]&#60;&#62;'0') then &#13;&#10;    strTmpStang := strTmpStang + kNum[StrToInt(strStang[2])];    &#13;&#10;  if (strTmpStang&#60;&#62;'') then&#13;&#10;    begin&#13;&#10;      strTmpStang := strTmpStang + 'สตางต์';&#13;&#10;      strTmpBaht := strTmpBaht + strTmpStang;&#13;&#10;    end&#13;&#10;  else if (strTmpBaht&#60;&#62;'') then &#13;&#10;    strTmpBaht := strTmpBaht +'ถ้วน';    &#13;&#10;  if (strTmpBaht&#60;&#62;'')  then&#13;&#10;    begin&#13;&#10;      strTmpBaht := StringReplace(strTmpBaht,'หนึ่งสิบ','สิบ');&#13;&#10;      strTmpBaht := StringReplace(strTmpBaht,'สิบหนึ่ง','สิบเอ็ด');&#13;&#10;      strTmpBaht := StringReplace(strTmpBaht,'สองสิบ','ยี่สิบ');          &#13;&#10;      Result := strTmpBaht;&#13;&#10;    end;&#13;&#10;end;      &#13;&#10;  &#13;&#10;&#13;&#10;&#13;&#10;procedure frxDBDataset1bdamountOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    MyTXT :=TextBaht(StrToFloat(&#60;frxDataset1.&#34;sum_total&#34;&#62;));  &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;begin  &#13;&#10;kLuk[1] := '';&#13;&#10;kLuk[2] := 'สิบ';&#13;&#10;kLuk[3] := 'ร้อย';&#13;&#10;kLuk[4] := 'พัน';&#13;&#10;kLuk[5] := 'หมื่น';&#13;&#10;kLuk[6] := 'แสน';&#13;&#10;kLuk[7] := 'ล้าน';&#13;&#10;kLuk[8] := 'สิบ';  &#13;&#10;kLuk[9] := 'ร้อย';&#13;&#10;kLuk[10] := 'พัน';    &#13;&#10;    &#13;&#10;kNum[0] := '';&#13;&#10;kNum[1] := 'หนึ่ง';&#13;&#10;kNum[2] := 'สอง';&#13;&#10;kNum[3] := 'สาม';&#13;&#10;kNum[4] := 'สี่';&#13;&#10;kNum[5] := 'ห้า';&#13;&#10;kNum[6] := 'หก';&#13;&#10;kNum[7] := 'เจ็ด';&#13;&#10;kNum[8] := 'แปด';  &#13;&#10;kNum[9] := 'เก้า';    &#13;&#10;end." PropData="044C656674026803546F7003300208446174617365747301010C3200000020446174615365743D22667278444244617461736574312220446174615365744E616D653D2266727844617461736574312200010C3200000020446174615365743D22667278444244617461736574322220446174615365744E616D653D226672784461746173657432220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="0" PaperWidth="135" PaperHeight="199" PaperSize="256" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Font.Charset="222" Font.Color="0" Font.Height="-24" Font.Name="Angsana New" Font.Style="1" Height="752.12598425" Left="0" ParentFont="False" Top="18.89765" Width="510.23655" ColumnWidth="0" ColumnGap="0" DataSet="frxDBDataset1" DataSetName="frxDataset1" RowCount="0">
      <TfrxMemoView Name="frxDBDataset1do_prename" Left="186.9765" Top="264.14193" Width="279.68522" Height="75.5906" ShowHint="False" DataSet="frxDBDataset1" DataSetName="frxDataset1" DisplayFormat.DecimalSeparator="." Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="[frxDataset1.&#34;do_prename&#34;][frxDataset1.&#34;FullName2&#34;]"/>
      <TfrxMemoView Name="frxDBDataset1bdamount" Left="267.83488" Top="326.51206" Width="154.96073" Height="18.89765" OnAfterPrint="frxDBDataset1bdamountOnAfterPrint" OnBeforePrint="frxDBDataset1bdamountOnBeforePrint" ShowHint="False" DataSet="frxDBDataset1" DataSetName="frxDataset1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[frxDataset1.&#34;sum_total&#34;]"/>
      <TfrxMemoView Name="frxDBDataset1bno" Left="210.02381" Top="688.71707" Width="253.22851" Height="18.89765" ShowHint="False" DataSet="frxDBDataset1" DataSetName="frxDataset1" DisplayFormat.DecimalSeparator="." Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[frxDataset1.&#34;bill1&#34;][IIF(Trim(&#60;frxDataset1.&#34;bill2&#34;&#62;)&#60;&#62;'',',' + &#60;frxDataset1.&#34;bill2&#34;&#62;,'')][IIF(Trim(&#60;frxDataset1.&#34;bill3&#34;&#62;)&#60;&#62;'',',' + &#60;frxDataset1.&#34;bill3&#34;&#62;,'')][IIF(Trim(&#60;frxDataset1.&#34;bill4&#34;&#62;)&#60;&#62;'',',' + &#60;frxDataset1.&#34;bill4&#34;&#62;,'')]"/>
      <TfrxMemoView Name="frxDBDataset1bdate1" Left="229.48052" Top="649.46506" Width="120.94496" Height="34.01574803" ShowHint="False" DataSet="frxDBDataset1" DataSetName="frxDataset1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="mmmm" DisplayFormat.Kind="fkDateTime" Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="[frxDataset1.&#34;bdate&#34;]"/>
      <TfrxMemoView Name="frxDBDataset1bdate" Left="136.55133" Top="649.46506" Width="60.47248" Height="34.01574803" ShowHint="False" DataSet="frxDBDataset1" DataSetName="frxDataset1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="dd" DisplayFormat.Kind="fkDateTime" Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="[frxDataset1.&#34;bdate&#34; #ddd]"/>
      <TfrxMemoView Name="frxDBDataset1bdate2" Left="371.22078" Top="650.00835" Width="79.37013" Height="34.01574803" ShowHint="False" DataSet="frxDBDataset1" DataSetName="frxDataset1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="yyyy" Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="[Copy(inttostr(YearOf(&#60;frxDataset1.&#34;bdate&#34;&#62;) + 543),3,2)]"/>
      <TfrxMemoView Name="Memo23" Left="110.85838" Top="345.52783" Width="366.61441" Height="34.01577" ShowHint="False" DisplayFormat.DecimalSeparator="." Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" ParentFont="False" Text="** [&#60;MyTXT&#62;]**                                                                "/>
      <TfrxMemoView Name="frxDBDataset2KEY_VALUE" Left="202.00804" Top="587.55164" Width="219.21274" Height="34.01574803" ShowHint="False" DataField="KEY_VALUE" DataSet="frxDBDataset2" DataSetName="frxDataset2" Font.Charset="222" Font.Color="0" Font.Height="-21" Font.Name="Angsana New" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[frxDataset2.&#34;KEY_VALUE&#34;]"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
