

/*GLR210*/
select
 gt1.DCDGT1, gt1.DNOGT1, gt1.DDTGT1,
 gt1.CMPGT1, gt1.BRNGT1, gt1.NARGT1,
 gt1.SEQGT1, gt1.PFXGT1, gt1.AGPGT1, gt1.ASGGT1, gt1.ATPGT1, gt1.ARNGT1,
 ac1.tnmac1,
 gt1.CHQGT1, gt1.DCRGT1, gt1.AMTGT1,
 cde.tnmcde
from
gskgt1   gt1
 inner join gskac1 ac1
 on      gt1.cmpgt1 = ac1.cmpac1 and
         gt1.AGPGT1 = ac1.agpac1 and
         gt1.ASGGT1 = ac1.asgac1 and
         gt1.ATPGT1 = ac1.atpac1 and
         gt1.ARNGT1 = ac1.arnac1
 left join bikcde cde
 on        cde.CIDCDE = 'DC' and
         cde.cnocde = gt1.dcdgt1

where gt1.ddtgt1 between :FDate and :Todate
order by  gt1.DCDGT1 , gt1.dnogt1,gt1.ddtgt1, gt1.AGPGT1, gt1.ASGGT1, gt1.ATPGT1, gt1.ARNGT1 ,gt1.SEQGT1, gt1.PFXGT1

/*GLR220*/
select
 gt1.DCDGT1, gt1.BRNGT1, gt1.DNOGT1, gt1.DDTGT1,
 gt1.CMPGT1, gt1.NARGT1,
 gt1.SEQGT1, gt1.PFXGT1, gt1.AGPGT1, gt1.ASGGT1, gt1.ATPGT1, gt1.ARNGT1,
 ac1.tnmac1,
 gt1.CHQGT1, gt1.DCRGT1, gt1.AMTGT1,
 cde.tnmcde
from
gskgt1   gt1
 inner join gskac1 ac1
 on      gt1.cmpgt1 = ac1.cmpac1 and
         gt1.AGPGT1 = ac1.agpac1 and
         gt1.ASGGT1 = ac1.asgac1 and
         gt1.ATPGT1 = ac1.atpac1 and
         gt1.ARNGT1 = ac1.arnac1
 left join bikcde cde
 on        cde.CIDCDE = 'DC' and
         cde.cnocde = gt1.dcdgt1

where gt1.ddtgt1 between :FDate and :Todate
order by  gt1.DCDGT1 , gt1.BRNGT1, gt1.ddtgt1 ,gt1.dnogt1, gt1.AGPGT1, gt1.ASGGT1, gt1.ATPGT1, gt1.ARNGT1 , gt1.SEQGT1, gt1.PFXGT1

/*GLRR40*/
select
 gt1.DCDGT1,
 cde.tnmcde,
 gt1.BRNGT1, gt1.DNOGT1, gt1.DDTGT1,

 gt1.CMPGT1, gt1.NARGT1, gt1.rdtgt1 , gt1.rnogt1,
 gt1.AGPGT1, gt1.ASGGT1, gt1.ATPGT1, gt1.ARNGT1,
 ac1.tnmac1,

 substring(gt1.pfxgt1 from 1 for 2) divorg,
 substring(gt1.pfxgt1 from 3 for 2) deporg,
 substring(gt1.pfxgt1 from 5 for 2) secorg,
 org.tnmorg ,

 gt1.CHQGT1, gt1.DCRGT1, gt1.AMTGT1
from
gskgt1   gt1
 left join gskac1 ac1
 on      gt1.cmpgt1 = ac1.cmpac1 and
         gt1.AGPGT1 = ac1.agpac1 and
         gt1.ASGGT1 = ac1.asgac1 and
         gt1.ATPGT1 = ac1.atpac1 and
         gt1.ARNGT1 = ac1.arnac1
 left join bikcde cde
 on        cde.CIDCDE = 'DC' and
         cde.cnocde = gt1.dcdgt1
 left join gskorg org
 on  gt1.cmpgt1 = org.cmporg and
     substring(gt1.pfxgt1 from 1 for 2)  = org.divorg and
     substring(gt1.pfxgt1 from 3 for 2)  = org.deporg and
     substring(gt1.pfxgt1 from 5 for 2)  = org.secorg


where gt1.DCDGT1 between :FDocCode and :TDocCode
and  gt1.dnogt1  between :Fno and :Tno
order by  gt1.dnogt1,gt1.AGPGT1, gt1.ASGGT1, gt1.ATPGT1, gt1.ARNGT1 , gt1.SEQGT1

/*GLR320*/
SELECT
 GMM.DCDGMM, GMM.DDTGMM, GMM.DNOGMM, GMM.NARGMM, GMM.SEQGMM, GMM.PFXGMM,
 GMM.CMPGMM, GMM.AGPGMM, GMM.ASGGMM, GMM.ATPGMM, GMM.ARNGMM, AC1.TNMAC1,
 GMM.CHQGMM, GMM.DCRGMM, GMM.AMTGMM,
 CDE.TNMCDE

FROM
GSKGMM   GMM
 LEFT JOIN GSKAC1 AC1
 ON      GMM.CMPGMM = AC1.CMPAC1 AND
         GMM.AGPGMM = AC1.AGPAC1 AND
         GMM.ASGGMM = AC1.ASGAC1 AND
         GMM.ATPGMM = AC1.ATPAC1 AND
         GMM.ARNGMM = AC1.ARNAC1

 left join BIKCDE CDE
 on        CDE.CIDCDE = 'DC' and
         CDE.CNOCDE = GMM.DCDGMM

WHERE
GMM.CMPGMM = :ASCOMPANY AND
GMM.PFXGMM = :ASPFXGMM  AND
GMM.YARGMM = :ASYEAR AND
--GMM.p
GMM.DDTGMM BETWEEN :FDATE AND :TODATE AND
GMM.DCDGMM = :DOC_CODE
ORDER BY  GMM.DCDGMM, GMM.DDTGMM, GMM.DNOGMM, GMM.SEQGMM

/*GLR310*/
SELECT
 GMM.CMPGMM, GMM.AGPGMM, GMM.ASGGMM, GMM.ATPGMM, GMM.ARNGMM, AC1.TNMAC1,
 GMM.AGPGMM||'-'||GMM.ASGGMM||'-'||GMM.ATPGMM||'-'||GMM.ARNGMM ACCCOD,
 GMM.PFXGMM, ORG.TNMORG,
 GMM.DDTGMM, GMM.DCDGMM, GMM.DNOGMM, GMM.NARGMM,
 GMM.CHQGMM, GMM.SEQGMM, GMM.DCRGMM, GMM.AMTGMM
FROM

GSKGMM   GMM

 LEFT JOIN GSKAC1 AC1
 ON      GMM.CMPGMM = AC1.CMPAC1 AND
         GMM.AGPGMM = AC1.AGPAC1 AND
         GMM.ASGGMM = AC1.ASGAC1 AND
         GMM.ATPGMM = AC1.ATPAC1 AND
         GMM.ARNGMM = AC1.ARNAC1

 LEFT JOIN GSKORG ORG
 ON  GMM.CMPGMM = ORG.CMPORG AND
     SUBSTRING(GMM.PFXGMM FROM 1 FOR 2)  = ORG.DIVORG AND
     SUBSTRING(GMM.PFXGMM FROM 3 FOR 2)  = ORG.DEPORG AND
     SUBSTRING(GMM.PFXGMM FROM 5 FOR 2)  = ORG.SECORG

WHERE
GMM.CMPGMM = :ASCOMPANY AND
GMM.PFXGMM = :ASPFXGMM  AND
GMM.YARGMM = :ASYEAR AND
--GMM.p
GMM.DDTGMM BETWEEN :FDATE AND :TODATE
/*
AND
GMM.AGPGMM = :AGPGMM AND
GMM.ASGGMM = :ASGGMM AND
GMM.ATPGMM = :ATPGMM AND
GMM.ARNGMM = :ARNGMM
*/

ORDER BY  GMM.CMPGMM, GMM.AGPGMM, GMM.ASGGMM, GMM.ATPGMM, GMM.ARNGMM,
          GMM.PFXGMM, GMM.DDTGMM, GMM.DCDGMM, GMM.DNOGMM, GMM.SEQGMM

/*GLR340 */
SELECT
 TYY.CMPTYY,TYY.AGPTYY, TYY.ASGTYY, TYY.ATPTYY, TYY.ARNTYY,
 TYY.AGPTYY||'-'||TYY.ASGTYY||'-'||TYY.ATPTYY||'-'||TYY.ARNTYY ACCCOD,
 'XXXXXXXX' ACC_DESC,
 --AC1.TNMAC1 ACC_DESC,
 TYY.PFXTYY , TYY.STTTYY ,
 TYY.A01TYY AMT_MONTH , TYY.A02TYY AMT_YEAR, TYY.BUTTYY,
 TYY.A03TYY BUT_MONTH , TYY.A04TYY BUT_YEAR
 --BYY.A01BYY BUT_MONTH , BYY.A02BYY BUT_YEAR
 
FROM
 GSKTYY TYY
/*
 LEFT JOIN GSKAC1 AC1
 ON TYY.CMPTYY = AC1.CMPAC1 AND
    TYY.AGPTYY = AC1.AGPAC1 AND
    TYY.ASGTYY = AC1.ASGAC1 AND
    TYY.ATPTYY = AC1.ATPAC1 AND
    TYY.ARNTYY = AC1.ARNAC1
 LEFT JOIN GSKBYY BYY
 ON TYY.CMPTYY = BYY.CMPBYY AND
    TYY.AGPTYY = BYY.AGPBYY AND
    TYY.ASGTYY = BYY.ASGBYY AND
    TYY.ATPTYY = BYY.ATPBYY AND
    TYY.ARNTYY = BYY.ARNBYY AND
    TYY.YARTYY = BYY.YARBYY 
*/

 WHERE
    TYY.CMPTYY = :COMPANY AND
    TYY.YARTYY = :YEAR  AND
    TYY.CMPTYY <> '' AND
    TYY.AGPTYY <> '' AND
    TYY.ASGTYY <> '' AND
    TYY.ATPTYY <> '' AND
    TYY.ARNTYY <> ''   
    
    
ORDER BY  TYY.CMPTYY, TYY.AGPTYY, TYY.ASGTYY, TYY.ATPTYY, TYY.ARNTYY    

/*GLR350*/
SELECT
 SUBSTRING ( TYY.PFXTYY FROM 1 FOR 2) PFXGRP, ORG.TNMORG ,TYY.CMPTYY,TYY.AGPTYY, TYY.ASGTYY, TYY.ATPTYY, TYY.ARNTYY,
 TYY.AGPTYY||'-'||TYY.ASGTYY||'-'||TYY.ATPTYY||'-'||TYY.ARNTYY ACCCOD,
 'XXXXXXXX' ACC_DESC,
 --AC1.TNMAC1 ACC_DESC,
 TYY.PFXTYY , TYY.STTTYY ,
 TYY.A01TYY AMT_MONTH , TYY.A02TYY AMT_YEAR, TYY.BUTTYY,
 TYY.A03TYY BUT_MONTH , TYY.A04TYY BUT_YEAR
 --BYY.A01BYY BUT_MONTH , BYY.A02BYY BUT_YEAR
 
FROM
 GSKTYY TYY
  LEFT JOIN GSKORG ORG
 ON  TYY.CMPTYY = ORG.CMPORG AND
     SUBSTRING(TYY.PFXTYY FROM 1 FOR 2)  = ORG.DIVORG AND
--     SUBSTRING(TYY.PFXTYY FROM 3 FOR 2)  = ORG.DEPORG AND
--     SUBSTRING(TYY.PFXTYY FROM 5 FOR 2)  = ORG.SECORG
     ''  = ORG.DEPORG AND
     ''  = ORG.SECORG

 WHERE
    TYY.CMPTYY = :COMPANY AND
    TYY.YARTYY = :YEAR  AND
    TYY.CMPTYY <> '' AND
    TYY.AGPTYY <> '' AND
    TYY.ASGTYY <> '' AND
    TYY.ATPTYY <> '' AND
    TYY.ARNTYY <> ''   
    
    
ORDER BY  1,  TYY.CMPTYY, TYY.AGPTYY, TYY.ASGTYY, TYY.ATPTYY, TYY.ARNTYY,TYY.PFXTYY

/*GLR330*/
SELECT
 TYY.PFXTYY ,ORG.TNMORG ,TYY.CMPTYY,TYY.AGPTYY, TYY.ASGTYY, TYY.ATPTYY, TYY.ARNTYY,
 TYY.AGPTYY||'-'||TYY.ASGTYY||'-'||TYY.ATPTYY||'-'||TYY.ARNTYY ACCCOD,
 'XXXXXXXX' ACC_DESC,
 --AC1.TNMAC1 ACC_DESC,
 TYY.STTTYY ,
 TYY.A01TYY AMT_MONTH , TYY.A02TYY AMT_YEAR, TYY.BUTTYY,
 TYY.A03TYY BUT_MONTH , TYY.A04TYY BUT_YEAR
 --BYY.A01BYY BUT_MONTH , BYY.A02BYY BUT_YEAR
 
FROM
 GSKTYY TYY
  LEFT JOIN GSKORG ORG
 ON  TYY.CMPTYY = ORG.CMPORG AND
     SUBSTRING(TYY.PFXTYY FROM 1 FOR 2)  = ORG.DIVORG AND
     SUBSTRING(TYY.PFXTYY FROM 3 FOR 2)  = ORG.DEPORG AND
     SUBSTRING(TYY.PFXTYY FROM 5 FOR 2)  = ORG.SECORG

 WHERE
    TYY.CMPTYY = :COMPANY AND
    TYY.YARTYY = :YEAR  AND
    TYY.CMPTYY <> '' AND
    TYY.AGPTYY <> '' AND
    TYY.ASGTYY <> '' AND
    TYY.ATPTYY <> '' AND
    TYY.ARNTYY <> ''   
    
    
ORDER BY  TYY.PFXTYY,  TYY.CMPTYY, TYY.AGPTYY, TYY.ASGTYY, TYY.ATPTYY, TYY.ARNTYY
