# เลือก ACCT CODE ใน DTB

SELECT D.AGPDTB, D.ASGDTB, D.ATPDTB, D.ARNDTB ,A.TNMAC1
FROM GSKDTB D
LEFT JOIN GSKAC1 A
  ON D.AGPDTB = A.AGPAC1
  AND D.ASGDTB = A.ASGAC1
  AND D.ATPDTB = A.ATPAC1
  AND D.ARNDTB = A.ARNAC1
GROUP BY
   D.AGPDTB,
   D.ASGDTB,
   D.ATPDTB,
   D.ARNDTB,
   A.TNMAC1

# เลือก FORDTB จาก ACCT CODE

SELECT D.FORDTB ,O.TNMORG
FROM GSKDTB D
LEFT JOIN GSKORG O
  ON SUBSTRING(D.FORDTB FROM 1 FOR 2) = O.CMPORG
  AND SUBSTRING(D.FORDTB FROM 3 FOR 2) = O.DIVORG
  AND SUBSTRING(D.FORDTB FROM 5 FOR 2) = O.DEPORG
  AND SUBSTRING(D.FORDTB FROM 7 FOR 2) = O.SECORG
WHERE D.AGPDTB = '1'
  AND D.ASGDTB = '2'
  AND D.ATPDTB = '10'
  AND D.ARNDTB = '030'
GROUP BY
  D.FORDTB ,O.TNMORG

#เลือก TODTB จาก FORDTB AND ACCT CODE

SELECT D.TORDTB ,O.TNMORG
FROM GSKDTB D
LEFT JOIN GSKORG O
  ON SUBSTRING(D.TORDTB FROM 1 FOR 2) = O.CMPORG
  AND SUBSTRING(D.TORDTB FROM 3 FOR 2) = O.DIVORG
  AND SUBSTRING(D.TORDTB FROM 5 FOR 2) = O.DEPORG
  AND SUBSTRING(D.TORDTB FROM 7 FOR 2) = O.SECORG
WHERE D.AGPDTB = '1'
  AND D.ASGDTB = '2'
  AND D.ATPDTB = '10'
  AND D.ARNDTB = '030'
  AND D.FORDTB = '0100'
GROUP BY
  D.TORDTB ,O.TNMORG
